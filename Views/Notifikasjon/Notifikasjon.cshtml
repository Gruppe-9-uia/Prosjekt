@{
    ViewData["Title"] = "Notifikasjon";

    var notifikasjoner = new List<dynamic>
{
        new { Melding = "Vinsjer levert til Hydro", Status = "Fullført", Avdeling = "Elektro", Merknad = "Ingen merknad tilgjengelig.", LastNedLink = (string?)null },
        new { Melding = "Vedlegg for Serviceordre #7200", Status = "Pågår", Avdeling = "Servicebehandler", Merknad = "Se vedlagt fil.", LastNedLink = "/path/to/your/samplefile.pdf" }
    };
}

<div class="container mt-5">
    <div class="d-flex align-items-start justify-content-between mb-4">
        <h2>Notifikasjoner</h2>
    </div>

    @for (int i = 0; i < notifikasjoner.Count; i++)
    {
        var notifikasjon = notifikasjoner[i];
        var badgeClass = notifikasjon.Status == "Fullført" ? "bg-success" : "bg-warning";
        var iconClass = notifikasjon.Status == "Fullført" ? "bi-check-square" : "bi-hourglass-split";

        <div class="alert border rounded p-3 mb-4 shadow-sm notifikasjon-div" role="alert">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-muted d-flex align-items-center fs-7">
                    <i class="bi bi-clock-history me-2 fs-7"></i> @DateTime.Now.ToString("G")
                </span>
                <div class="d-flex align-items-center">
                    <span class="me-3 bi bi-bookmark fs-6 text-muted bookmark-icon" title="Bokmerk melding" onclick="toggleBookmark(this)"></span>
                    <button type="button" class="btn-close"></button>
                </div>
            </div>
            <p class="mb-1 fs-5 font-weight-bolder text-start">@notifikasjon.Melding</p>
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center mb-1 fs-6">
                    <i class="bi @iconClass me-2"></i> <span class="badge @badgeClass ms-1">@notifikasjon.Status</span>
                    <span class="ms-2 text-muted fs-6"> <i class="bi bi-house-door me-2"></i> @notifikasjon.Avdeling</span>
                </div>
                <div class="d-flex align-items-center">
                    @if (!string.IsNullOrEmpty(notifikasjon.Merknad) || !string.IsNullOrEmpty(notifikasjon.LastNedLink))
                    {
                        <button class="btn btn-outline-secondary merknad-button btn-sm mb-2 fs-7" type="button" onclick="toggleMerknad(@i)">
                            Vis merknad
                        </button>
                    }
                </div>
            </div>

            @if (!string.IsNullOrEmpty(notifikasjon.Merknad) || !string.IsNullOrEmpty(notifikasjon.LastNedLink))
            {
                <div class="merknad-content" style="display: none;">
                    <div class="mt-1 p-2 rounded bg-light border">
                        <h6 class="d-flex align-items-center mb-1 fs-7"><i class="bi bi-sticky me-2 fs-7"></i>Merknad:</h6>
                        @if (string.IsNullOrEmpty(notifikasjon.LastNedLink))
                        {
                            <p class="fs-7">@notifikasjon.Merknad</p>
                        }
                        else
                        {
                            <a href="@notifikasjon.LastNedLink" class="btn btn-sm btn-outline-primary" download>Last ned fil</a>
                        }
                    </div>
                </div>
            }
        </div> 
    }
</div> 

<!-- tror ikke vi skal bruke javascript-->
<script>function toggleMerknad(index) {
        var merknadContent = document.querySelectorAll('.merknad-content');
        merknadContent[index].style.display = (merknadContent[index].style.display === 'none' || merknadContent[index].style.display === '') ? 'block' : 'none';
    }

    function toggleBookmark(element) {
        if (element.classList.contains("bi-bookmark")) {
            element.classList.remove("bi-bookmark");
            element.classList.add("bi-bookmark-fill");
        } else {
            element.classList.remove("bi-bookmark-fill");
            element.classList.add("bi-bookmark");
        }
    }</script>